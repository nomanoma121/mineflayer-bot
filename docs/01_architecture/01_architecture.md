# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ - ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆã®è©³ç´°è§£èª¬

## ğŸ“– ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã®Minecraftãƒœãƒƒãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€**è¤‡æ•°ã®é«˜åº¦ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®æ©Ÿèƒ½ã‚’çµ±åˆã—ãŸå¤§è¦æ¨¡ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚·ã‚¹ãƒ†ãƒ **ã§ã™ã€‚TypeScriptã§å®Ÿè£…ã•ã‚Œã€mineflayerãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’åŸºç›¤ã¨ã—ã¦ã€ç‹¬è‡ªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªï¼ˆBotScriptï¼‰ã¾ã§å«ã‚€åŒ…æ‹¬çš„ãªãƒœãƒƒãƒˆåˆ¶å¾¡ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### å…¨ä½“æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Minecraft Server                             â”‚
â”‚                   â†‘ Minecraft Protocol â†“                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Mineflayer Framework                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Bot Core System                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚    Bot      â”‚  â”‚ CommandHandler â”‚ â”‚   State    â”‚             â”‚
â”‚  â”‚  (Facade)   â”‚â†â†’â”‚   (Command)    â”‚â†â†’â”‚  Machine   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â†‘                       â”‚                               â”‚
â”‚         â”‚                       â†“                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Ability    â”‚  â”‚         BotScript Language              â”‚   â”‚
â”‚  â”‚  Manager    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ (Composite) â”‚  â”‚  â”‚ Lexer   â”‚â†’â”‚ Parser  â”‚â†’â”‚Interpreterâ”‚  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚         â†‘          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Individual Abilities                        â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚ â”‚ Vitals  â”‚ â”‚Sensing  â”‚ â”‚Inventory â”‚ â”‚     Say     â”‚   â”‚    â”‚
â”‚  â”‚ â”‚ (Health)â”‚ â”‚(Perception)â”‚(Items)  â”‚ â”‚(Communication)â”‚   â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 1. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆPresentation Layerï¼‰
```typescript
// Minecraftãƒãƒ£ãƒƒãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®ç›¸äº’ä½œç”¨ã‚’å‡¦ç†
src/index.ts          // ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
src/core/Bot.ts       // ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰
```

### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆApplication Layerï¼‰  
```typescript
// ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
src/core/CommandHandler.ts     // ã‚³ãƒãƒ³ãƒ‰å‡¦ç†çµ±æ‹¬
src/commands/*.ts              // å€‹åˆ¥ã‚³ãƒãƒ³ãƒ‰å®Ÿè£…
src/states/*.ts                // çŠ¶æ…‹ç®¡ç†
```

### 3. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆDomain Layerï¼‰
```typescript
// ã‚³ã‚¢ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã¨ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
src/abilities/*.ts             // ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ 
src/botscript/                 // è‡ªä½œè¨€èªã‚¨ãƒ³ã‚¸ãƒ³
```

### 4. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ï¼ˆInfrastructure Layerï¼‰
```typescript
// å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®æ¥ç¶š
mineflayer                     // Minecraftæ¥ç¶š
minecraft-data                 // ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
```

## ğŸ”§ ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

### Bot ã‚¯ãƒ©ã‚¹ï¼ˆFacade Patternï¼‰

```typescript
// src/core/Bot.ts
export class Bot {
  private mc: mineflayer.Bot;           // Mineflayerãƒœãƒƒãƒˆå®Ÿè£…
  private abilityManager: AbilityManager; // ã‚¢ãƒ“ãƒªãƒ†ã‚£çµ±æ‹¬ç®¡ç†
  private currentState: IBotState;      // ç¾åœ¨ã®çŠ¶æ…‹
  
  // å¤–éƒ¨APIã‚’çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§æä¾›
  public async goto(x: number, y: number, z: number): Promise<void> {
    const { goals } = await import('mineflayer-pathfinder');
    const goal = new goals.GoalBlock(x, y, z);
    await this.mc.pathfinder.goto(goal);
  }
}
```

**è¨­è¨ˆåˆ¤æ–­**:
- è¤‡é›‘ãªmineflayer APIã‚’å˜ç´”åŒ–
- ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ ã¸ã®çµ±ä¸€ã‚¢ã‚¯ã‚»ã‚¹
- çŠ¶æ…‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã®é€£æº
- ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š

### CommandHandler ã‚¯ãƒ©ã‚¹ï¼ˆCommand Patternï¼‰

```typescript
// src/core/CommandHandler.ts
export class CommandHandler {
  private commands: Map<string, ICommand> = new Map();
  
  public registerCommand(name: string, command: ICommand): void {
    this.commands.set(name.toLowerCase(), command);
  }
  
  public async handleMessage(username: string, message: string): Promise<void> {
    // ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
    const parsedMessage = this.parseMessage(message);
    if (parsedMessage.shouldHandle) {
      const command = this.commands.get(parsedMessage.command);
      await command?.execute(this.bot, username, parsedMessage.args);
    }
  }
}
```

**è¨­è¨ˆåˆ¤æ–­**:
- ã‚³ãƒãƒ³ãƒ‰ã®å‹•çš„ç™»éŒ²ãƒ»å‰Šé™¤
- çµ±ä¸€ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®é›†ç´„
- æ‹¡å¼µæ€§ã®ç¢ºä¿

### State Systemï¼ˆState Patternï¼‰

```typescript
// src/states/IBotState.ts
export interface IBotState {
  enter(bot: Bot): void;
  execute(bot: Bot): Promise<void>;
  exit(bot: Bot): void;
  getName(): string;
}

// çŠ¶æ…‹å®Ÿè£…ä¾‹
export class IdleState implements IBotState {
  private static instance: IdleState;
  
  public static getInstance(): IdleState {
    if (!IdleState.instance) {
      IdleState.instance = new IdleState();
    }
    return IdleState.instance;
  }
  
  public enter(bot: Bot): void {
    console.log('[State] Entering Idle state');
  }
  
  public async execute(bot: Bot): Promise<void> {
    // å¾…æ©ŸçŠ¶æ…‹ã®ãƒ­ã‚¸ãƒƒã‚¯
    await new Promise(resolve => setTimeout(resolve, 100));
  }
}
```

**è¨­è¨ˆåˆ¤æ–­**:
- ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã«ã‚ˆã‚‹ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–
- çŠ¶æ…‹é·ç§»ã®æ˜ç¢ºåŒ–
- å„çŠ¶æ…‹ã®è²¬ä»»åˆ†é›¢
- ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„æ§‹é€ 

## ğŸ§  BotScriptè¨€èªã‚·ã‚¹ãƒ†ãƒ 

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
```
[Source Code] â†’ [Lexer] â†’ [Tokens] â†’ [Parser] â†’ [AST] â†’ [Interpreter] â†’ [Bot Actions]
     â†‘             â†‘         â†‘          â†‘         â†‘          â†‘             â†‘
   æ–‡å­—åˆ—        å­—å¥è§£æ   ãƒˆãƒ¼ã‚¯ãƒ³åˆ—   æ§‹æ–‡è§£æ   æŠ½è±¡æ§‹æ–‡æœ¨  ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿   å®Ÿéš›ã®å®Ÿè¡Œ
```

### å„å±¤ã®è²¬å‹™

#### 1. Lexerï¼ˆå­—å¥è§£æå±¤ï¼‰
```typescript
// src/botscript/lexer/Lexer.ts
export class Lexer {
  public tokenize(): Token[] {
    // ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã«åˆ†è§£
    // "SAY \"Hello\"" â†’ [SAY, STRING("Hello")]
  }
}
```

#### 2. Parserï¼ˆæ§‹æ–‡è§£æå±¤ï¼‰
```typescript
// src/botscript/parser/Parser.ts  
export class Parser {
  public parse(): ProgramNode {
    // ãƒˆãƒ¼ã‚¯ãƒ³åˆ—ã‚’ASTã«å¤‰æ›
    // å†å¸°ä¸‹é™ãƒ‘ãƒ¼ã‚µãƒ¼ã«ã‚ˆã‚‹æ§‹æ–‡è§£æ
  }
}
```

#### 3. Interpreterï¼ˆå®Ÿè¡Œå±¤ï¼‰
```typescript
// src/botscript/interpreter/Interpreter.ts
export class Interpreter {
  public async execute(ast: ProgramNode): Promise<ExecutionResult> {
    // ASTã‚’èµ°æŸ»ã—ã¦ãƒœãƒƒãƒˆå‹•ä½œã‚’å®Ÿè¡Œ
    // Visitor ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ASTå‡¦ç†
  }
}
```

## ğŸ”„ ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ ï¼ˆComposite Patternï¼‰

### è¨­è¨ˆæ€æƒ³
- **å˜ä¸€è²¬ä»»åŸå‰‡**: å„ã‚¢ãƒ“ãƒªãƒ†ã‚£ã¯ç‰¹å®šã®æ©Ÿèƒ½ã®ã¿ã‚’æ‹…å½“
- **é–‹æ”¾é–‰é–åŸå‰‡**: æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã«æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãªã„
- **ä¾å­˜æ€§é€†è»¢**: é«˜ãƒ¬ãƒ™ãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯æŠ½è±¡ã«ä¾å­˜

### ã‚¢ãƒ“ãƒªãƒ†ã‚£éšå±¤æ§‹é€ 

```typescript
// src/abilities/AbilityManager.ts
export class AbilityManager {
  private abilities: Map<string, IAbility> = new Map();
  
  public getAbility<T extends IAbility>(name: string): T | undefined {
    return this.abilities.get(name) as T;
  }
  
  // ä¾¿åˆ©ãªã‚¢ã‚¯ã‚»ã‚µãƒ¼
  public get vitals(): VitalsAbility {
    return this.getAbility('vitals') as VitalsAbility;
  }
}

// å„ã‚¢ãƒ“ãƒªãƒ†ã‚£ã®å®Ÿè£…
export class VitalsAbility implements IAbility {
  public isHealthLow(): boolean {
    return this.bot.mc.health < 6;
  }
  
  public isHungry(): boolean {
    return this.bot.mc.food < 6;
  }
}
```

### ã‚¢ãƒ“ãƒªãƒ†ã‚£ç¨®é¡ã¨è²¬å‹™

| ã‚¢ãƒ“ãƒªãƒ†ã‚£ | è²¬å‹™ | ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰ |
|-----------|------|-------------|
| **Vitals** | ç”Ÿå‘½ç¶­æŒãƒ»å¥åº·ç®¡ç† | `isHealthLow()`, `isHungry()`, `findSafeSpot()` |
| **Sensing** | ç’°å¢ƒèªçŸ¥ãƒ»æ„ŸçŸ¥ | `findNearestEntity()`, `isNight()`, `detectPlayers()` |
| **Inventory** | æ‰€æŒå“ç®¡ç† | `hasItem()`, `selectBestTool()`, `countItems()` |
| **Say** | ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | `say()`, `reportError()`, `reportStatus()` |

## ğŸ“¦ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ è§£èª¬

```
src/
â”œâ”€â”€ index.ts                    # ğŸšª ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ core/                       # ğŸ›ï¸ ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ Bot.ts                 # ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰
â”‚   â””â”€â”€ CommandHandler.ts      # ã‚³ãƒãƒ³ãƒ‰å‡¦ç†çµ±æ‹¬
â”œâ”€â”€ commands/                   # ğŸ® ãƒãƒ£ãƒƒãƒˆã‚³ãƒãƒ³ãƒ‰å®Ÿè£…
â”‚   â”œâ”€â”€ ICommand.ts           # ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ GoCommand.ts          # ç§»å‹•ã‚³ãƒãƒ³ãƒ‰
â”‚   â”œâ”€â”€ SayCommand.ts         # ç™ºè¨€ã‚³ãƒãƒ³ãƒ‰
â”‚   â””â”€â”€ BotScriptCommand.ts   # BotScriptå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
â”œâ”€â”€ states/                     # ğŸ”„ çŠ¶æ…‹ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…
â”‚   â”œâ”€â”€ IBotState.ts          # çŠ¶æ…‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ IdleState.ts          # å¾…æ©ŸçŠ¶æ…‹
â”‚   â”œâ”€â”€ MovingState.ts        # ç§»å‹•çŠ¶æ…‹
â”‚   â””â”€â”€ AttackingState.ts     # æ”»æ’ƒçŠ¶æ…‹
â”œâ”€â”€ abilities/                  # ğŸ§© ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ IAbility.ts           # ã‚¢ãƒ“ãƒªãƒ†ã‚£åŸºåº•ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ AbilityManager.ts     # ã‚¢ãƒ“ãƒªãƒ†ã‚£çµ±æ‹¬ç®¡ç†
â”‚   â”œâ”€â”€ VitalsAbility.ts      # ç”Ÿå‘½ç¶­æŒã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ SensingAbility.ts     # æ„ŸçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ InventoryAbility.ts   # æ‰€æŒå“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â””â”€â”€ SayAbility.ts         # ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ botscript/                  # ğŸ¤– è‡ªä½œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª
â”‚   â”œâ”€â”€ lexer/                # å­—å¥è§£æ
â”‚   â”‚   â”œâ”€â”€ Lexer.ts         # ãƒ¬ã‚­ã‚µãƒ¼å®Ÿè£…
â”‚   â”‚   â””â”€â”€ TokenType.ts     # ãƒˆãƒ¼ã‚¯ãƒ³å‹å®šç¾©
â”‚   â”œâ”€â”€ parser/               # æ§‹æ–‡è§£æ
â”‚   â”‚   â”œâ”€â”€ Parser.ts        # ãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£…
â”‚   â”‚   â””â”€â”€ ASTNode.ts       # ASTç¯€ç‚¹å®šç¾©
â”‚   â””â”€â”€ interpreter/          # å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
â”‚       â”œâ”€â”€ Interpreter.ts   # ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å®Ÿè£…
â”‚       â””â”€â”€ ExecutionContext.ts # å®Ÿè¡Œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â””â”€â”€ __mocks__/                  # ğŸ§ª ãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒƒã‚¯
    â””â”€â”€ MinecraftBotMock.ts   # mineflayerãƒ¢ãƒƒã‚¯
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æˆ¦ç•¥

### 1. ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–
```typescript
// ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹çŠ¶æ…‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å…±æœ‰
export class IdleState implements IBotState {
  private static instance: IdleState;
  
  public static getInstance(): IdleState {
    if (!IdleState.instance) {
      IdleState.instance = new IdleState();
    }
    return IdleState.instance;
  }
}
```

### 2. è¨ˆç®—æœ€é©åŒ–
```typescript
// Pathfinderè¨­å®šã«ã‚ˆã‚‹ç§»å‹•åŠ¹ç‡åŒ–
bot.mc.pathfinder.setMovements(new Movements(bot.mc));
bot.mc.pathfinder.setGoal(goal);
```

### 3. éåŒæœŸå‡¦ç†
```typescript
// Promise.allã«ã‚ˆã‚‹ä¸¦åˆ—å®Ÿè¡Œ
await Promise.all([
  this.updateHealthStatus(),
  this.updateInventoryStatus(),
  this.updatePositionStatus()
]);
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ†ã‚¹ãƒˆéšå±¤

```
ãƒ†ã‚¹ãƒˆç¨®é¡                 ã‚«ãƒãƒ¬ãƒƒã‚¸å¯¾è±¡                  ãƒ•ã‚¡ã‚¤ãƒ«æ•°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Unit Tests              å€‹åˆ¥ã‚¯ãƒ©ã‚¹ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰              ~200ãƒ†ã‚¹ãƒˆ
Integration Tests       ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“é€£æº              ~50ãƒ†ã‚¹ãƒˆ  
System Tests           ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰å‹•ä½œ               ~30ãƒ†ã‚¹ãƒˆ
Performance Tests      å®Ÿè¡Œæ™‚é–“ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡             ~32ãƒ†ã‚¹ãƒˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åˆè¨ˆ                                                    312ãƒ†ã‚¹ãƒˆ
```

### ãƒ¢ãƒƒã‚¯æˆ¦ç•¥
```typescript
// src/__mocks__/MinecraftBotMock.ts
export const createMockBot = (): any => ({
  health: 20,
  food: 20,
  time: { timeOfDay: 6000, day: 1 },
  players: new Map(),
  inventory: { items: () => [] },
  // 150ä»¥ä¸Šã®è©³ç´°ãªãƒ¢ãƒƒã‚¯å®Ÿè£…
});
```

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«

### 1. ãƒœãƒƒãƒˆèµ·å‹•ãƒ•ãƒ­ãƒ¼
```
index.ts
  â†“ ãƒœãƒƒãƒˆä½œæˆ
Bot.constructor()
  â†“ ã‚¢ãƒ“ãƒªãƒ†ã‚£åˆæœŸåŒ–
AbilityManager.initialize()
  â†“ çŠ¶æ…‹è¨­å®š
Bot.changeState(IdleState)
  â†“ ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ç™»éŒ²
CommandHandler.registerCommands()
  â†“ ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
Bot.setupEventListeners()
  â†“ å®Ÿè¡Œãƒ«ãƒ¼ãƒ—é–‹å§‹
Bot.mainLoop()
```

### 2. ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãƒ•ãƒ­ãƒ¼
```
Minecraftãƒãƒ£ãƒƒãƒˆ
  â†“ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡
CommandHandler.handleMessage()
  â†“ ã‚³ãƒãƒ³ãƒ‰è§£æ
CommandHandler.parseMessage()
  â†“ ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
ICommand.execute()
  â†“ çŠ¶æ…‹å¤‰æ›´ï¼ˆå¿…è¦æ™‚ï¼‰
Bot.changeState()
  â†“ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
Bot/Ability methods
```

### 3. BotScriptå®Ÿè¡Œãƒ•ãƒ­ãƒ¼
```
BotScriptã‚³ãƒãƒ³ãƒ‰
  â†“ ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å—ä¿¡
BotScriptCommand.execute()
  â†“ å­—å¥è§£æ
Lexer.tokenize()
  â†“ æ§‹æ–‡è§£æ
Parser.parse()
  â†“ ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ
Interpreter.execute()
  â†“ ãƒœãƒƒãƒˆåˆ¶å¾¡
Bot Actions
```

## ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹çµ±è¨ˆ
```
è¨€èª: TypeScript
ç·è¡Œæ•°: ~8,000è¡Œ
ãƒ•ã‚¡ã‚¤ãƒ«æ•°: ~60ãƒ•ã‚¡ã‚¤ãƒ«
ãƒ†ã‚¹ãƒˆæ•°: 312ãƒ†ã‚¹ãƒˆ
ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸: >95%
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
```
èµ·å‹•æ™‚é–“: ~2ç§’
ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ~50MB
ã‚³ãƒãƒ³ãƒ‰å¿œç­”æ™‚é–“: <100ms
BotScriptå®Ÿè¡Œæ™‚é–“: <50ms
```

## ğŸ“ ç·´ç¿’å•é¡Œ

### ğŸŸ¢ åˆç´šå•é¡Œ
**å•é¡Œ**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸»è¦ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’3ã¤æŒ™ã’ã€ãã‚Œãã‚ŒãŒã©ã®ã‚¯ãƒ©ã‚¹ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

**ä¸»è¦ãƒ‘ã‚¿ãƒ¼ãƒ³**:
1. **Facade Pattern** - `Bot`ã‚¯ãƒ©ã‚¹
   - è¤‡é›‘ãªmineflayer APIã‚’å˜ç´”åŒ–
   - ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ ã¸ã®çµ±ä¸€ã‚¢ã‚¯ã‚»ã‚¹

2. **Command Pattern** - `CommandHandler`ã¨`ICommand`å®Ÿè£…
   - ãƒãƒ£ãƒƒãƒˆã‚³ãƒãƒ³ãƒ‰ã®å‹•çš„ç™»éŒ²ãƒ»å®Ÿè¡Œ
   - ã‚³ãƒãƒ³ãƒ‰ã®ã‚«ãƒ—ã‚»ãƒ«åŒ–

3. **State Pattern** - `IBotState`å®Ÿè£…ã‚¯ãƒ©ã‚¹ç¾¤
   - ãƒœãƒƒãƒˆã®çŠ¶æ…‹ã«å¿œã˜ãŸå‹•ä½œå¤‰æ›´
   - çŠ¶æ…‹é·ç§»ã®ç®¡ç†

**ãƒ†ã‚¹ãƒˆæ–¹æ³•**:
```typescript
test('architecture patterns verification', () => {
  // Facade Pattern
  expect(bot).toHaveProperty('goto');
  expect(bot).toHaveProperty('vitals');
  
  // Command Pattern  
  expect(commandHandler.commands.size).toBeGreaterThan(0);
  
  // State Pattern
  expect(bot.getCurrentState()).toBeInstanceOf(IdleState);
});
```
</details>

### ğŸŸ¡ ä¸­ç´šå•é¡Œ
**å•é¡Œ**: BotScriptã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã«ãŠã„ã¦ã€ã‚¨ãƒ©ãƒ¼ãŒã©ã®æ®µéšã§ç™ºç”Ÿã—ã€ã©ã®ã‚ˆã†ã«å‡¦ç†ã•ã‚Œã‚‹ã‹ã‚’æ®µéšåˆ¥ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

**ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ®µéšã¨å‡¦ç†**:

1. **å­—å¥è§£ææ®µéš** (Lexer)
   ```typescript
   // ç„¡åŠ¹ãªæ–‡å­—ã«å¯¾ã™ã‚‹ã‚¨ãƒ©ãƒ¼
   throw new Error(`Unexpected character: ${char} at line ${this.line}`);
   ```

2. **æ§‹æ–‡è§£ææ®µéš** (Parser)
   ```typescript
   // æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹ãƒ‘ãƒ‹ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰å›å¾©
   private synchronize(): void {
     // ã‚¨ãƒ©ãƒ¼å›å¾©å‡¦ç†
   }
   ```

3. **å®Ÿè¡Œæ®µéš** (Interpreter)
   ```typescript
   // å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ã®ã‚­ãƒ£ãƒƒãƒã¨è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
   catch (error) {
     return {
       type: ExecutionResultType.ERROR,
       message: `Execution error: ${error.message}`,
       context: this.context
     };
   }
   ```

**ãƒ†ã‚¹ãƒˆæ–¹æ³•**:
```typescript
test('error handling at each stage', async () => {
  // å­—å¥è§£æã‚¨ãƒ©ãƒ¼
  expect(() => new Lexer('invalid@char').tokenize()).toThrow();
  
  // æ§‹æ–‡è§£æã‚¨ãƒ©ãƒ¼
  expect(() => new Parser([/* ç„¡åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ */]).parse()).toThrow();
  
  // å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼
  const result = await interpreter.execute(invalidAST);
  expect(result.type).toBe(ExecutionResultType.ERROR);
});
```
</details>

### ğŸ”´ ä¸Šç´šå•é¡Œ
**å•é¡Œ**: æ–°ã—ã„ã‚¢ãƒ“ãƒªãƒ†ã‚£ï¼ˆ`CraftingAbility`ï¼‰ã‚’è¿½åŠ ã™ã‚‹å ´åˆã®è¨­è¨ˆã‚’ã€æ—¢å­˜ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã£ã¦å®Ÿè£…è¨ˆç”»ã‚’ç«‹ã¦ã¦ãã ã•ã„ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆã€ä¾å­˜é–¢ä¿‚ã€ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã¾ã§å«ã‚ã¦è¨­è¨ˆã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹</summary>

**CraftingAbility è¨­è¨ˆè¨ˆç”»**:

```typescript
// 1. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
export interface ICraftingAbility extends IAbility {
  canCraft(itemName: string): boolean;
  craft(itemName: string, quantity?: number): Promise<boolean>;
  getCraftableItems(): string[];
  getRequiredMaterials(itemName: string): ItemRequirement[];
}

// 2. å®Ÿè£…ã‚¯ãƒ©ã‚¹
export class CraftingAbility implements ICraftingAbility {
  constructor(private bot: Bot) {}
  
  public getName(): string {
    return 'crafting';
  }
  
  public async initialize(): Promise<void> {
    // Crafting table detection logic
  }
  
  public canCraft(itemName: string): boolean {
    const recipe = this.getRecipe(itemName);
    return this.hasRequiredMaterials(recipe);
  }
  
  public async craft(itemName: string, quantity = 1): Promise<boolean> {
    if (!this.canCraft(itemName)) {
      throw new Error(`Cannot craft ${itemName}: missing materials`);
    }
    
    // Crafting implementation using mineflayer
    return await this.performCrafting(itemName, quantity);
  }
}

// 3. AbilityManageræ‹¡å¼µ
export class AbilityManager {
  public get crafting(): CraftingAbility {
    return this.getAbility('crafting') as CraftingAbility;
  }
}

// 4. BotScriptçµ±åˆ
// æ–°ã—ã„CRAFTã‚³ãƒãƒ³ãƒ‰ã‚’BotScriptã«è¿½åŠ 
case 'CraftCommand':
  await this.executeCraftCommand(statement as CraftCommandNode);
  break;

// 5. ãƒ†ã‚¹ãƒˆæˆ¦ç•¥
describe('CraftingAbility', () => {
  it('should check material availability', () => {
    // ãƒãƒ†ãƒªã‚¢ãƒ«ç¢ºèªãƒ†ã‚¹ãƒˆ
  });
  
  it('should perform crafting operation', async () => {
    // ã‚¯ãƒ©ãƒ•ãƒˆå®Ÿè¡Œãƒ†ã‚¹ãƒˆ
  });
  
  it('should integrate with BotScript', async () => {
    // BotScriptçµ±åˆãƒ†ã‚¹ãƒˆ
  });
});
```

**ä¾å­˜é–¢ä¿‚å›³**:
```
CraftingAbility
    â†“ ä¾å­˜
InventoryAbility (ææ–™ç¢ºèª)
    â†“ ä¾å­˜  
SensingAbility (Crafting Tableæ¤œå‡º)
    â†“ ä¾å­˜
Bot (mineflayer API)
```

**çµ±åˆãƒã‚¤ãƒ³ãƒˆ**:
1. `AbilityManager`ã¸ã®ç™»éŒ²
2. `BotScript`ã¸ã®`CRAFT`ã‚³ãƒãƒ³ãƒ‰è¿½åŠ 
3. ãƒãƒ£ãƒƒãƒˆã‚³ãƒãƒ³ãƒ‰`CraftCommand`ã®å®Ÿè£…
4. æ—¢å­˜ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã¸ã®è¿½åŠ 
</details>

## ğŸ† è‡ªå·±è©•ä¾¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] **åˆç´š**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸»è¦ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] **ä¸­ç´š**: BotScriptã‚·ã‚¹ãƒ†ãƒ ã®å„å±¤ã®è²¬å‹™ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ç†è§£ã—ã¦ã„ã‚‹  
- [ ] **ä¸Šç´š**: æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®è¨­è¨ˆæ‰‹æ³•ã¨æ—¢å­˜ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã®æ•´åˆæ€§ã‚’è€ƒæ…®ã§ãã‚‹

## ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç†è§£ã—ãŸã‚‰ã€æ¬¡ã¯**[ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³](./02_design_patterns.md)**ã§å…·ä½“çš„ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…è©³ç´°ã‚’å­¦ã³ã€ãã®å¾Œ**[ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ ](./08_ability_system.md)**ã§ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼è¨­è¨ˆã®å®Ÿè·µã‚’å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚